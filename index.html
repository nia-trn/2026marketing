<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Renatural â€” 2026 Marketing Master Timeline</title>
  <style>
    :root {
      --bg: #0a0a0a;
      --bg2: #111;
      --bg3: #1a1a1a;
      --text: #fff;
      --text2: #aaa;
      --text3: #666;
      --border: rgba(255,255,255,0.1);
      --gold: #e8d5b7;
      --orange: rgba(255,200,100,0.8);
      --acq: #1a2e26;
      --con: #2e2e1a;
      --cvr: #2e1a26;
      --ret: #1a262e;
      --acq-text: #4a9a7a;
      --con-text: #9a9a4a;
      --cvr-text: #9a4a7a;
      --ret-text: #4a7a9a;
      --left-width: 610px;
      --row-height: auto;
    }
    
    .light {
      --bg: #f5f5f5;
      --bg2: #fff;
      --bg3: #e8e8e8;
      --text: #1a1a1a;
      --text2: #555;
      --text3: #888;
      --border: rgba(0,0,0,0.1);
      --acq: #d4e8df;
      --con: #e8e8d4;
      --cvr: #e8d4df;
      --ret: #d4dfe8;
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      font-size: 11px;
      line-height: 1.4;
      overflow: hidden;
      height: 100vh;
    }
    
    /* NAV */
    .nav {
      position: fixed;
      top: 0; left: 0; right: 0;
      z-index: 1000;
      background: var(--bg2);
      border-bottom: 1px solid var(--border);
      padding: 10px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 48px;
    }
    .nav-title { font-weight: 600; font-size: 13px; }
    .nav-btns { display: flex; gap: 5px; flex-wrap: wrap; }
    .nav-btn {
      padding: 4px 10px;
      font-size: 10px;
      background: var(--bg3);
      border: 1px solid var(--border);
      color: var(--text2);
      border-radius: 3px;
      cursor: pointer;
    }
    .nav-btn:hover { background: var(--border); color: var(--text); }
    .nav-right { display: flex; gap: 8px; align-items: center; }
    .search {
      padding: 4px 8px;
      font-size: 10px;
      background: var(--bg3);
      border: 1px solid var(--border);
      color: var(--text);
      border-radius: 3px;
      width: 120px;
    }
    
    /* METRICS */
    .metrics {
      position: fixed;
      top: 48px; left: 0; right: 0;
      z-index: 999;
      background: var(--bg2);
      border-bottom: 1px solid var(--border);
      padding: 8px 20px;
      display: flex;
      gap: 20px;
      font-size: 11px;
      height: 36px;
    }
    .metrics span { color: var(--text3); margin-right: 4px; }
    
    /* MAIN LAYOUT - Two panels */
    .main {
      position: fixed;
      top: 84px;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
    }
    
    /* LEFT PANEL - Fixed */
    .left-panel {
      width: var(--left-width);
      flex-shrink: 0;
      overflow-y: auto;
      overflow-x: hidden;
      border-right: 3px solid var(--gold);
      background: var(--bg);
    }
    
    /* RIGHT PANEL - Scrollable */
    .right-panel {
      flex: 1;
      overflow: auto;
    }
    
    /* ROW STRUCTURE */
    .row-left {
      display: grid;
      grid-template-columns: 140px 150px 180px 140px;
      border-bottom: 1px solid var(--border);
    }
    
    .row-right {
      display: grid;
      grid-template-columns: repeat(12, 85px) 180px 170px 170px;
      border-bottom: 1px solid var(--border);
    }
    
    .cell {
      padding: 10px 8px;
      border-right: 1px solid var(--border);
      min-height: 80px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    
    .cell:last-child { border-right: none; }
    
    /* HEADER */
    .header-row .cell {
      background: var(--bg3);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--text2);
      text-align: center;
      min-height: 50px;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    .header-row .cell.left-cell {
      text-align: left;
    }
    
    /* QUARTER COLORS */
    .q1 { background: rgba(74,154,122,0.3) !important; color: #4a9a7a !important; }
    .q2 { background: rgba(154,122,74,0.3) !important; color: #9a7a4a !important; }
    .q3 { background: rgba(122,74,154,0.3) !important; color: #7a4a9a !important; }
    .q4 { background: rgba(154,74,74,0.3) !important; color: #9a4a4a !important; }
    
    /* GATE */
    .gate { border-right: 3px solid var(--orange) !important; }
    
    /* TIER DIVIDER */
    .tier-left, .tier-right {
      padding: 12px 16px;
      font-weight: 600;
      font-size: 12px;
      letter-spacing: 0.1em;
      cursor: pointer;
      min-height: 44px;
      display: flex;
      align-items: center;
      border-bottom: 1px solid var(--border);
    }
    
    .tier-left.acq, .tier-right.acq { background: #1a3d30; color: var(--acq-text); }
    .tier-left.con, .tier-right.con { background: #3d3d1a; color: var(--con-text); }
    .tier-left.cvr, .tier-right.cvr { background: #3d1a30; color: var(--cvr-text); }
    .tier-left.ret, .tier-right.ret { background: #1a303d; color: var(--ret-text); }
    
    .light .tier-left.acq, .light .tier-right.acq { background: #b8d8c8; }
    .light .tier-left.con, .light .tier-right.con { background: #d8d8b8; }
    .light .tier-left.cvr, .light .tier-right.cvr { background: #d8b8c8; }
    .light .tier-left.ret, .light .tier-right.ret { background: #b8c8d8; }
    
    .arrow { margin-right: 8px; display: inline-block; transition: transform 0.2s; }
    .tier-left.collapsed .arrow { transform: rotate(-90deg); }
    
    /* DATA ROW COLORS */
    .data-row.acq .cell { background: var(--acq); }
    .data-row.con .cell { background: var(--con); }
    .data-row.cvr .cell { background: var(--cvr); }
    .data-row.ret .cell { background: var(--ret); }
    
    /* Content Production distinct color - still acquisition but visually separate */
    .data-row.acq.content-prod .cell { background: #1e3333; }
    .light .data-row.acq.content-prod .cell { background: #cce0e0; }
    
    /* Right side cells need default bg */
    .right-panel .data-row .cell { background: var(--bg); }
    
    .data-row.hidden { display: none; }
    .data-row.filtered { display: none; }
    
    /* CONTENT STYLES */
    .name { font-weight: 600; font-size: 11px; }
    .tag { font-size: 8px; letter-spacing: 0.1em; opacity: 0.6; display: block; margin-bottom: 2px; text-transform: uppercase; }
    .think { color: var(--text2); font-style: italic; white-space: pre-line; }
    .plat { white-space: pre-line; font-size: 10px; }
    
    /* MONTH CELLS */
    .mon { text-align: center; justify-content: center; align-items: center; }
    .mon.empty { background: rgba(255,255,255,0.02) !important; color: var(--text3); }
    .mon.mile { background: rgba(232,213,183,0.15) !important; }
    .ms { color: var(--gold); font-weight: 600; font-size: 10px; }
    .act { font-size: 9px; color: var(--text2); }
    .bar { height: 4px; border-radius: 2px; margin-top: 6px; background: rgba(255,255,255,0.08); }
    .i1 { width: 20%; background: rgba(255,255,255,0.15); }
    .i2 { width: 40%; background: rgba(255,255,255,0.25); }
    .i3 { width: 60%; background: rgba(255,255,255,0.35); }
    .i4 { width: 80%; background: rgba(255,255,255,0.45); }
    .i5 { width: 100%; background: rgba(255,255,255,0.55); }
    
    /* END COLUMNS */
    .miles { background: rgba(232,213,183,0.1) !important; color: var(--gold); }
    .deps { background: rgba(100,150,255,0.1) !important; color: #8ab4ff; }
    .risk { background: rgba(255,100,100,0.1) !important; color: #ff9999; }
    .risk.low { background: rgba(255,255,255,0.02) !important; color: var(--text3); }
    .risk.crit { background: rgba(255,50,50,0.2) !important; color: #ff6666; font-weight: 600; }
    
    /* FOOTER */
    .footer-left, .footer-right {
      padding: 20px;
      font-size: 10px;
      color: var(--text3);
      border-top: 1px solid var(--border);
    }
    
    /* NOTES at bottom of left panel */
    .notes {
      padding: 20px;
      border-top: 1px solid var(--border);
    }
    .note {
      background: #3d3d1a;
      border: 1px solid #5a5a2d;
      padding: 10px 12px;
      font-size: 10px;
      border-radius: 3px;
      margin-bottom: 10px;
    }
    .note.rsk { background: #3d1a1a; border-color: #5a2d2d; color: #ffaaaa; }
    .light .note { background: #fffde7; border-color: #f0e68c; color: #333; }
    .light .note.rsk { background: #ffebee; border-color: #ef9a9a; color: #c62828; }
    
    @media (max-width: 1100px) { .nav-btns { display: none; } }
  </style>
</head>
<body>

<nav class="nav">
  <div class="nav-title">The Renatural â€” 2026 Timeline</div>
  <div class="nav-btns">
    <button class="nav-btn" onclick="scrollQ(0)">Q1</button>
    <button class="nav-btn" onclick="scrollQ(3)">Q2</button>
    <button class="nav-btn" onclick="scrollQ(6)">Q3</button>
    <button class="nav-btn" onclick="scrollQ(9)">Q4</button>
    <button class="nav-btn" onclick="scrollT('acq')">Acquisition</button>
    <button class="nav-btn" onclick="scrollT('con')">Consideration</button>
    <button class="nav-btn" onclick="scrollT('cvr')">Conversion</button>
    <button class="nav-btn" onclick="scrollT('ret')">Retention</button>
    <button class="nav-btn" onclick="toggleAll()">Expand/Collapse</button>
    <button class="nav-btn" onclick="toggleMiles()">Milestones</button>
  </div>
  <div class="nav-right">
    <input class="search" placeholder="Filter..." oninput="filter(this.value)">
    <button class="nav-btn" onclick="toggleTheme()">â˜€/ðŸŒ™</button>
  </div>
</nav>

<div class="metrics" id="metrics"></div>

<div class="main">
  <div class="left-panel" id="leftPanel"></div>
  <div class="right-panel" id="rightPanel"></div>
</div>

<script src="data.js"></script>
<script>
const M = ['jan','feb','mar','apr','may','jun','jul','aug','sep','oct','nov','dec'];
const ML = ['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC'];
const GATES = [2, 5, 8]; // indices: mar, jun, sep
const QTR = ['q1','q1','q1','q2','q2','q2','q3','q3','q3','q4','q4','q4'];

const tierMap = {
  acquisition: {id:'acq', name:'TIER 1: ACQUISITION', budget:'$473K Total Budget'},
  consideration: {id:'con', name:'TIER 2: CONSIDERATION', budget:'Nurture & Engagement'},
  conversion: {id:'cvr', name:'TIER 3: CONVERSION', budget:'Purchase'},
  retention: {id:'ret', name:'TIER 4: RETENTION', budget:'Lifetime Value'}
};

let collapsed = {};
let milesMode = false;
let rowIndex = 0;

document.addEventListener('DOMContentLoaded', init);

function init() {
  renderMetrics();
  renderPanels();
  syncScroll();
  
  // Sync row heights after DOM renders
  requestAnimationFrame(() => {
    syncRowHeights();
  });
  
  // Re-sync on window resize
  window.addEventListener('resize', syncRowHeights);
}

function renderMetrics() {
  const m = CONFIG.metrics;
  document.getElementById('metrics').innerHTML = `
    <div><span>Revenue:</span> ${m.revenueTarget}</div>
    <div><span>Wigs:</span> ${m.wigs}</div>
    <div><span>Accessories:</span> ${m.accessories}</div>
    <div><span>Budget:</span> ${m.totalBudget}</div>
    <div><span>CAC:</span> ${m.wigCAC}</div>
    <div><span>CVR:</span> ${m.targetCVR}</div>
    <div><span>Sessions:</span> ${m.sessionsNeeded}</div>
  `;
}

function renderPanels() {
  let left = '';
  let right = '';
  rowIndex = 0;
  
  // Header
  left += `<div class="row-left header-row">
    <div class="cell left-cell">Swimlane</div>
    <div class="cell left-cell">Customer Thinking</div>
    <div class="cell left-cell">Platforms</div>
    <div class="cell left-cell">Budget / Role</div>
  </div>`;
  
  right += `<div class="row-right header-row">
    ${ML.map((m,i) => `<div class="cell ${QTR[i]}${GATES.includes(i)?' gate':''}">${m}</div>`).join('')}
    <div class="cell">Key Milestones</div>
    <div class="cell">Dependencies</div>
    <div class="cell">Risk if Late</div>
  </div>`;
  
  // Tiers and data
  TIERS.forEach(tier => {
    const t = tierMap[tier.id];
    
    // Tier divider
    const tierLabel = t.budget ? `${t.name} â€” ${t.budget}` : t.name;
    left += `<div class="tier-left ${t.id}" id="tier-${t.id}" onclick="toggle('${t.id}')"><span class="arrow">â–¼</span>${tierLabel}</div>`;
    right += `<div class="tier-right ${t.id}"></div>`;
    
    // Data rows
    SWIMLANES.filter(s => s.tier === tier.id).forEach(sw => {
      const rid = `row-${rowIndex++}`;
      left += renderLeftRow(sw, t.id, rid);
      right += renderRightRow(sw, t.id, rid);
    });
  });
  
  // Footer - left only
  left += `<div class="footer-left">The Renatural â€” 2026 Marketing Timeline</div>`;
  
  document.getElementById('leftPanel').innerHTML = left;
  document.getElementById('rightPanel').innerHTML = right;
}

function renderLeftRow(sw, tid, rid) {
  const extraClass = sw.id === 'content-production' ? ' content-prod' : '';
  return `<div class="row-left data-row ${tid}${extraClass}" data-t="${tid}" data-r="${rid}" data-n="${sw.name.toLowerCase()}" data-search="${sw.name.toLowerCase()} ${sw.customerThinking.toLowerCase()} ${sw.platforms.toLowerCase()} ${sw.budget.toLowerCase()} ${sw.role.toLowerCase()}">
    <div class="cell"><span class="tag">${tid}</span><span class="name">${sw.name}</span></div>
    <div class="cell think">${sw.customerThinking}</div>
    <div class="cell plat">${sw.platforms}</div>
    <div class="cell"><strong>${sw.budget}</strong><br>${sw.role}</div>
  </div>`;
}

function renderRightRow(sw, tid, rid) {
  const rc = sw.riskLevel === 'low' ? 'low' : sw.riskLevel === 'critical' ? 'crit' : '';
  const extraClass = sw.id === 'content-production' ? ' content-prod' : '';
  
  // Build search string from all month activities and milestones
  const monthText = Object.values(sw.months).map(m => `${m.activity || ''} ${m.milestone || ''}`).join(' ').toLowerCase();
  const searchText = `${sw.milestones.toLowerCase()} ${sw.dependencies.toLowerCase()} ${sw.risk.toLowerCase()} ${monthText}`;
  
  let months = M.map((m,i) => {
    const d = sw.months[m] || {activity:'â€”',intensity:0};
    const isEmpty = d.intensity === 0;
    const hasMile = d.milestone;
    const isGate = GATES.includes(i);
    let cls = 'cell mon';
    if (isEmpty) cls += ' empty';
    if (hasMile) cls += ' mile';
    if (isGate) cls += ' gate';
    
    return `<div class="${cls}">
      ${hasMile ? `<span class="ms">${d.milestone}</span>` : ''}
      <span class="act">${d.activity}</span>
      ${d.intensity > 0 ? `<div class="bar i${d.intensity}"></div>` : ''}
    </div>`;
  }).join('');
  
  return `<div class="row-right data-row ${tid}${extraClass}" data-t="${tid}" data-r="${rid}" data-n="${sw.name.toLowerCase()}" data-search="${searchText}">
    ${months}
    <div class="cell miles">${sw.milestones.replace(/\n/g,'<br>')}</div>
    <div class="cell deps">${sw.dependencies.replace(/\n/g,'<br>')}</div>
    <div class="cell risk ${rc}">${sw.risk.replace(/\n/g,'<br>')}</div>
  </div>`;
}

function syncScroll() {
  const left = document.getElementById('leftPanel');
  const right = document.getElementById('rightPanel');
  
  left.addEventListener('scroll', () => {
    right.scrollTop = left.scrollTop;
  });
  
  right.addEventListener('scroll', () => {
    left.scrollTop = right.scrollTop;
  });
}

function syncRowHeights() {
  // Get all matching row pairs
  const leftRows = document.querySelectorAll('#leftPanel .row-left, #leftPanel .tier-left');
  const rightRows = document.querySelectorAll('#rightPanel .row-right, #rightPanel .tier-right');
  
  leftRows.forEach((leftRow, i) => {
    const rightRow = rightRows[i];
    if (!rightRow) return;
    
    // Reset heights first
    leftRow.style.minHeight = 'auto';
    rightRow.style.minHeight = 'auto';
    
    // Get natural heights
    const leftHeight = leftRow.offsetHeight;
    const rightHeight = rightRow.offsetHeight;
    
    // Set both to the max
    const maxHeight = Math.max(leftHeight, rightHeight);
    leftRow.style.minHeight = maxHeight + 'px';
    rightRow.style.minHeight = maxHeight + 'px';
  });
}

function toggle(id) {
  collapsed[id] = !collapsed[id];
  document.getElementById('tier-'+id).classList.toggle('collapsed', collapsed[id]);
  
  document.querySelectorAll(`.data-row[data-t="${id}"]`).forEach(el => {
    el.classList.toggle('hidden', collapsed[id]);
  });
  
  // Re-sync heights after visibility change
  requestAnimationFrame(syncRowHeights);
}

function toggleAll() {
  const expand = Object.values(collapsed).some(v => v);
  ['acq','con','cvr','ret'].forEach(id => {
    collapsed[id] = !expand;
    const el = document.getElementById('tier-'+id);
    if (el) el.classList.toggle('collapsed', !expand);
    document.querySelectorAll(`.data-row[data-t="${id}"]`).forEach(r => {
      r.classList.toggle('hidden', !expand);
    });
  });
  
  requestAnimationFrame(syncRowHeights);
}

function toggleMiles() {
  milesMode = !milesMode;
  document.querySelectorAll('.mon').forEach(c => {
    c.style.opacity = milesMode ? (c.classList.contains('mile') ? '1' : '0.15') : '1';
  });
}

function filter(q) {
  q = q.toLowerCase().trim();
  document.querySelectorAll('.data-row').forEach(r => {
    const nameMatch = r.dataset.n && r.dataset.n.includes(q);
    const searchMatch = r.dataset.search && r.dataset.search.includes(q);
    const match = !q || nameMatch || searchMatch;
    r.classList.toggle('filtered', !match);
  });
  
  requestAnimationFrame(syncRowHeights);
}

function scrollQ(monthIndex) {
  const right = document.getElementById('rightPanel');
  right.scrollLeft = monthIndex * 85;
}

function scrollT(id) {
  if (collapsed[id]) toggle(id);
  const el = document.getElementById('tier-'+id);
  if (el) {
    document.getElementById('leftPanel').scrollTop = el.offsetTop - 60;
  }
}

function toggleTheme() {
  document.body.classList.toggle('light');
}
</script>
</body>
</html>
